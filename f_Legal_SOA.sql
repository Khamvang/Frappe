

-- Legal SOA case 
SELECT
	-- Contract info
		c.contract_no,
		CASE WHEN c.status = 0 THEN 'Pending' 
			WHEN c.status = 1 THEN 'Pending Approval'
			WHEN c.status = 2 THEN 'Pending Disbursement' 
			WHEN c.status = 3 THEN 'Disbursement Approval'
			WHEN c.status = 4 THEN 'Active' 
			WHEN c.status = 5 THEN 'Cancelled'
			WHEN c.status = 6 THEN 'Refinance' 
			WHEN c.status = 7 THEN 'Closed' 
			ELSE NULL
		END `contract_status`,
		c.ncn,
		p.loan_amount,
		p.trading_currency,
		(p.loan_amount /
	            (CASE WHEN p.trading_currency = 'USD' THEN 1 
	                    WHEN p.trading_currency = 'LAK' THEN cr.usd2lak 
	                    WHEN p.trading_currency = 'THB' THEN cr.usd2thb
	            end)
		) AS `usd_loan_amount`,
		p.monthly_interest, 
		p.no_of_payment,
		CASE 
			WHEN p.payment_schedule_type = 1 THEN 'Installment' 
			WHEN p.payment_schedule_type = 2 THEN 'One-time' 
			WHEN p.payment_schedule_type = 3 THEN 'Bullet-MOU'
		END AS `payment_schedule_type`,
		c.contract_date,
		p.first_payment_date,
		p.last_payment_date,
	-- 
	-- Customer info
	    CONVERT(CAST(CONVERT(CONCAT(cu.customer_first_name_lo, ' ', cu.customer_last_name_lo, ' - ', cu.customer_first_name_en, ' ', cu.customer_last_name_en) USING latin1) AS binary) USING utf8) AS customer_name,
	    CASE 
		    WHEN LEFT (RIGHT (REPLACE ( cu.main_contact_no, ' ', '') ,8),1) = '0' 
				THEN CONCAT('903',RIGHT (REPLACE ( cu.main_contact_no, ' ', '') ,8))
			WHEN length (REPLACE ( cu.main_contact_no, ' ', '')) = 7 
				THEN CONCAT('9030',REPLACE ( cu.main_contact_no, ' ', ''))
			ELSE CONCAT('9020', RIGHT(REPLACE ( cu.main_contact_no, ' ', '') , 8))
		END AS `customer_tel`,
	    CONCAT(LEFT(pv.province_name, LOCATE('-', pv.province_name) - 2), ' - ', ci.city_name) AS address_province_and_city,
	    CONVERT(CAST(CONVERT(v.village_name_lao USING latin1) AS binary) USING utf8) AS address_village,
	-- 
	-- Guarantor info
		CONVERT(CAST(CONVERT(
						CONCAT(g.guarantor_first_name_lo, ' ', g.guarantor_last_name_lo, ' - ', g.guarantor_first_name_en, ' ', g.guarantor_last_name_en) 
					USING latin1) 
				AS binary) 
		USING utf8) AS `guarantor_name`,
	    CASE 
		    WHEN LEFT (RIGHT (REPLACE ( g.guarantor_contact_no, ' ', '') ,8),1) = '0' 
				THEN CONCAT('903',RIGHT (REPLACE ( g.guarantor_contact_no, ' ', '') ,8))
			WHEN length (REPLACE ( g.guarantor_contact_no, ' ', '')) = 7 
				THEN CONCAT('9030',REPLACE ( g.guarantor_contact_no, ' ', ''))
			ELSE CONCAT('9020', RIGHT(REPLACE ( g.guarantor_contact_no, ' ', '') , 8))
		END AS `guarantor_tel`,
		CASE 
			WHEN g.guarantor_relationship = 1 THEN 'Father' 
			WHEN g.guarantor_relationship = 2 THEN 'Mother'
			WHEN g.guarantor_relationship = 3 THEN 'Husband' 
			WHEN g.guarantor_relationship = 4 THEN 'Wife'
			WHEN g.guarantor_relationship = 5 THEN 'Children' 
			WHEN g.guarantor_relationship = 6 THEN 'Older Brother'
			WHEN g.guarantor_relationship = 7 THEN 'Older Sister' 
			WHEN g.guarantor_relationship = 8 THEN 'Younger Brother'
			WHEN g.guarantor_relationship = 8 THEN 'Younger Sister' 
			WHEN g.guarantor_relationship = 10 THEN 'Uncle'
			WHEN g.guarantor_relationship = 11 THEN 'Aunt' 
			WHEN g.guarantor_relationship = 12 THEN 'Cousin'
			WHEN g.guarantor_relationship = 13 THEN 'Son' 
			WHEN g.guarantor_relationship = 14 THEN 'Daughter'
			ELSE 
				CONVERT(CAST(CONVERT( g.guarantor_relationship_others USING latin1) AS binary) USING utf8)
		END `guarantor_relationship`,
	-- Car info
		car.car_make,
		CONVERT( CAST(CONVERT( CONCAT(car.car_model) USING LATIN1)
			AS BINARY) USING UTF8) AS `car_model`,
		av.collateral_year AS `car_year`,
		CASE 
			WHEN av.number_plate_numbers IS NOT NULL 
				THEN CONVERT(CAST(CONVERT(CONCAT( av.number_plate_letters, ' ', av.number_plate_numbers ) USING latin1) AS binary) USING utf8)
			ELSE CONVERT(CAST(CONVERT( av.number_plate USING latin1) AS binary) USING utf8)
		END AS `number_plate`,
		av.collateral_engine_no AS `engine_no`,
		av.collateral_vin_code AS `vin_code`,
	-- car sold info
		csa.`car_sold_amount`,
	-- 
	-- Collected amount
		cre.total_principal_collected AS `principal_collected`,
		cre.total_interest_collected AS `interest_collected`,
		cre.total_penalty_collected AS `penalty_collected`,
		cre.total_others_collected AS `others_collected`,
		cre.total_accrual_collected AS `accrual_collected`,
	-- 
	-- Collected amount
		cre.total_principal_void AS `principal_void`,
		cre.total_interest_void AS `interest_void`,
		cre.total_penalty_void AS `penalty_void`,
	-- 
	-- Outstanding amount
		cre.last_collection_date AS `last_collection_date`,
		cre.fully_paid_installment_date AS `full_paid_date`,
		cre.total_principal_outstanding AS `total_principal_outstanding`,
	-- 
		(
			cre.total_interest_outstanding
		+
			(CASE
				WHEN c.status != 4 THEN ''
				ELSE
				( 
					(cre.last_interest_amount / 30) 
					* (	CASE
							WHEN cre.last_payment_date >= CURDATE() THEN 0
							ELSE TIMESTAMPDIFF(DAY, cre.last_payment_date, CURDATE()) 
						END
						)
				)		
			END)
		) AS `total_interest_outstanding`,
	-- 
		(
			cre.current_penalty_outstanding
		+
			(CASE
				WHEN c.status != 4 THEN ''
				WHEN penalty_method = 2 
					THEN
							cre.total_principal_outstanding 
						* 
							0.1
						* 
							( CASE
								WHEN cre.last_payment_date >= CURDATE() THEN 0
								ELSE TIMESTAMPDIFF(DAY, cre.last_payment_date, CURDATE()) 
							END )
					ELSE
						(	CEIL(	(
									(last_principal_amount + last_interest_amount) 
								*
									(CASE
										WHEN CAST(c.ncn AS UNSIGNED) < 19390 THEN 0.03 
										ELSE 0.05
									END)
								)
							+ 	(30 
									* 
							            (	CASE WHEN p.trading_currency = 'USD' THEN 1 
							                    WHEN p.trading_currency = 'LAK' THEN cr.usd2lak 
							                    WHEN p.trading_currency = 'THB' THEN cr.usd2thb
							            	END
							            )
								)
							)
						* 
							( CASE 
									WHEN cre.last_payment_date >= CURDATE() THEN 0
									ELSE TIMESTAMPDIFF(MONTH, cre.last_payment_date, CURDATE()) 
								END 
							)
						)
			END)
		) AS `total_penalty_outstanding`,
		cre.total_interest_outstanding AS `interest_outstanding_in_contract`,
		cre.current_penalty_outstanding As `penalty_outstanding_in_contract`,
	-- 
	-- interest_outstanding_after_contract_end
		CASE
			WHEN c.status != 4 THEN ''
			ELSE
			( 
				(cre.last_interest_amount / 30) 
				* (	CASE
						WHEN cre.last_payment_date >= CURDATE() THEN 0
						ELSE TIMESTAMPDIFF(DAY, cre.last_payment_date, CURDATE()) 
					END
					)
			)		
		END AS `interest_outstanding_after_contract_end`,
	-- 
	-- penalty_outstanding_after_contract_end
		CASE
			WHEN c.status != 4 THEN ''
			WHEN penalty_method = 2 
				THEN
						cre.total_principal_outstanding 
					* 
						0.1
					* 
						( CASE
							WHEN cre.last_payment_date >= CURDATE() THEN 0
							ELSE TIMESTAMPDIFF(DAY, cre.last_payment_date, CURDATE()) 
						END )
				ELSE
					(	CEIL(	(
								(last_principal_amount + last_interest_amount) 
							*
								(CASE
									WHEN CAST(c.ncn AS UNSIGNED) < 19390 THEN 0.03 
									ELSE 0.05
								END)
							)
						+ 	(30 
								* 
						            (	CASE WHEN p.trading_currency = 'USD' THEN 1 
						                    WHEN p.trading_currency = 'LAK' THEN cr.usd2lak 
						                    WHEN p.trading_currency = 'THB' THEN cr.usd2thb
						            	END
						            )
							)
						)
					* 
						( CASE 
								WHEN cre.last_payment_date >= CURDATE() THEN 0
								ELSE TIMESTAMPDIFF(MONTH, cre.last_payment_date, CURDATE()) 
							END 
						)
					)
		END AS `penalty_outstanding_after_contract_end`,
	-- 
		p.last_payment_date,
	-- 
	-- Outstanding amount after contract end
		CASE 
			WHEN c.status != 4 THEN ''
			WHEN cre.last_payment_date >= CURDATE() THEN 0
			ELSE TIMESTAMPDIFF(MONTH, cre.last_payment_date, CURDATE()) 
		END AS `months_passed_after_contract_end`,
	-- 
		CASE
			WHEN c.status != 4 THEN ''
			WHEN cre.last_payment_date >= CURDATE() THEN 0
			ELSE TIMESTAMPDIFF(DAY, cre.last_payment_date, CURDATE()) 
		END AS `days_passed_after_contract_end`,
	-- 
		CASE
			WHEN c.status != 4 THEN ''
			WHEN penalty_method = 2 THEN 'remaing P * 0.1 * delay days'
			WHEN CAST(c.ncn AS UNSIGNED) < 19390 THEN '(P + I ) * 0.03 + 30$'
			ELSE '(P + I ) * 0.05 + 30$'
		END AS `penalty_method`,
	-- 
	-- exchange_rate
		CASE 
			WHEN c.status != 4 THEN ''
			WHEN p.trading_currency = 'USD' THEN 1 
            WHEN p.trading_currency = 'LAK' THEN cr.usd2lak 
            WHEN p.trading_currency = 'THB' THEN cr.usd2thb
    	END AS `exchange_rate`
FROM tblcontract c
LEFT JOIN tblcontractreport cre ON (c.id = cre.contract_id )
LEFT JOIN (
			SELECT 
				contract_id, SUM(payment_amount) AS `car_sold_amount`
			FROM tblcollection  
			WHERE collection_method = 3 and status = 1
			GROUP BY contract_id
			) AS csa 
			ON csa.contract_id = c.id
LEFT JOIN tblprospect p ON p.id = c.prospect_id
LEFT JOIN tblcustomer cu ON cu.id = p.customer_id
LEFT JOIN tblguarantor g 
	ON g.id = (SELECT id FROM tblguarantor WHERE prospect_id = c.prospect_id ORDER BY id ASC LIMIT 0, 1)
LEFT JOIN tblvillage v ON cu.address_village_id = v.id
LEFT JOIN tblcity ci ON ci.id = cu.address_city
LEFT JOIN tblprovince pv ON pv.id = cu.address_province
LEFT JOIN (
		SELECT pa2.prospect_id, SUM(av2.min_buying_price) AS `min_buying_price` 
		FROM tblprospectasset pa2 
		LEFT JOIN tblassetvaluation av2 ON av2.id = pa2.assetvaluation_id
		GROUP BY pa2.prospect_id
	) AS am 
	ON p.id = am.prospect_id
LEFT JOIN tblprospectasset pa
	ON pa.prospect_id = p.id AND pa.assetvaluation_id = (SELECT assetvaluation_id 
								FROM tblprospectasset pa1 
								LEFT JOIN tblassetvaluation av1 ON av1.id = pa1.assetvaluation_id
								WHERE pa1.prospect_id = p.id 
								ORDER BY av1.min_buying_price DESC 
								LIMIT 0, 1 )
LEFT JOIN tblassetvaluation av ON av.id = pa.assetvaluation_id
LEFT JOIN tblcar car ON av.collateral_car_id = car.id
LEFT JOIN tblbusinesstype bt ON (bt.code = cu.business_type)
LEFT JOIN tblcurrencyrate cr ON (cr.date_for = date_format(now(), '%Y-%m-01'))
LEFT JOIN tbluser us ON (us.id = p.salesperson_id)
WHERE c.status IN (4, 6, 7)
	AND c.contract_no IN (2107772, 2084230, 2105255, 2049711, 2013108, 2076084, 2028627, 2063456, 2071322, 2105771, 2101446, 2086063, 2100149, 2090226, 2097692, 2074858, 2091039, 2111045, 2064410, 2037905, 2108592, 2063362, 2101745, 2094250, 2100324, 2091175, 2109735, 2086135, 2048812, 2108365, 2068283, 2005009, 2045027, 2112090, 2067709, 2108798, 2066310, 2104382, 2108020, 2087832, 2053207, 2085128, 2079031, 2076082, 2082302, 2101096, 2076035, 2099872, 2080962, 2111446, 2107785, 2112749, 2085490, 2079418, 2087381, 2093769, 2087965, 2066202, 2092178, 2002811, 2096010, 2089658, 2098917, 2080858, 2103192, 2087418, 2107267, 2101879, 2083671, 2091629, 2070594, 2076357, 2060735, 2073898, 2111100, 2096232, 2075783, 2099277, 2116516, 2057336, 2090960, 2102491, 2052784, 2068101, 2039095, 2031179, 2071256, 2070766, 2067717, 2078586, 2047151, 2061858, 2105811, 2091115, 2091321, 2101330, 2104633, 2099449, 2042045, 2105356, 2046231, 2038046, 2048784, 2078447, 2030186, 2040318, 2103367, 2093540, 2115419, 2111956, 2105294, 2022915, 2072876, 2099622, 2002144, 2086577, 2019132, 2080294, 2083012, 2077333, 2111959, 2112875, 2085777, 2078304, 2060633, 2104107, 2008875, 2097141, 2089444, 2025169, 2089715, 2092591, 2082193, 2035298, 2095404, 2090026, 2091769, 2097094, 2071026, 2089981, 2064667, 2008686, 2098560, 2039584, 2079006, 2000138, 2104843, 2101375, 2053381, 2085760, 2076543, 2086255, 2110159, 2107726, 2005757, 2111741, 2089033, 2095732, 2117196, 2084050, 2100874, 2112731, 2004937, 2096680, 2029881, 2082960, 2108856, 2107907, 2104563, 2093341, 2100273, 2075951, 2049830, 2070058, 2097981, 2048558, 2093592, 2070259, 2060941, 2084374, 2012818, 2090940, 2088081, 2007956, 2106353, 2054035, 2014976, 2069126, 2082844, 2103450, 2042775, 2101696, 2050303, 2086413, 2032255, 2087040, 2106912, 2106821, 2020588, 2004105, 2088088, 2097657, 2001670, 2053747, 2102156, 2085036, 2087267, 2018318, 2079264, 2103368, 2067213, 2107798, 2646, 2104178, 3003, 2087129, 2112266, 2110522, 2108972, 2101716, 2053284, 2111636, 2063865, 2065229, 2055763, 2105338, 2051875, 2105571, 2042803, 2083898, 2106139, 2113121, 2079790, 2007012, 2101462, 2111478, 2047491, 2075033, 2058664, 2084879, 2068686, 2067335, 2070503, 2096531, 2111329, 2098462, 2015283, 2109614, 2018300, 2112345, 2103598, 2096302, 2069534, 2104666, 2054391, 2107701, 2064521, 2113070, 2101735, 2067272, 2029563, 2092005, 2107566, 2076003, 2065246, 2106587, 2081518, 2053062, 2073049, 2051495, 2000098, 2013898, 2104159, 2089557, 2107351, 2055573, 2000637, 2000223, 2100881, 2110143, 2090689, 2038114, 2108107, 2106893, 2086034, 2094988, 2000932, 2046958, 2105139, 2004302, 2056179, 2088344, 2103903, 2097498, 2086139, 2110609, 2039059, 2013905, 2088506, 2110467, 2053685, 2090607, 2084981, 2003838, 2078863, 2110555, 2108597, 2004733, 2064394, 2021400, 2084795, 2072713, 2109135, 2091283, 2061966, 2081072, 2078328, 2052848, 2038062, 2052648, 2063461, 2036439, 2058682, 2100047, 2093217, 2030984, 2087761, 2064709, 2104480, 2072824, 2087773, 2086484, 2029047, 2058501, 2086643, 2003718, 2062990, 2087616, 2030939, 2011519, 2073809, 2086834, 2034693, 2113344, 2076044, 2110271, 2083075, 2081050, 2078835, 2060920, 2102144, 2112384, 4642, 2001671, 2055919, 2090389, 2044514, 2077307, 2082075, 2109412, 2111685, 2097145, 2046187, 2080466, 2077590, 2106094, 2000597, 3139, 2127, 2108088, 2076111, 2091758, 2112873, 2112309, 2027231, 2031457, 2106295, 2093453, 2099550, 2113915, 2113858, 2112442, 2001141, 2025518, 2030769, 2108302, 2110051, 2080880, 2087921, 2097993, 2060931, 2092077, 2081219, 2115648, 2078539, 2094428, 2084421, 2065307, 2012306, 2099121, 2059247, 2014588, 2084604, 2092462, 2014995, 2108764, 2019537, 2106564, 2084009, 2092407, 2056371, 2084260, 2014817, 2102662, 2114405, 2037995, 2112410, 2091108, 2072230, 2019834, 2098136, 2003503, 2111492, 2085164, 2111730, 2090937, 2110522, 2089077, 2111657, 2090929, 2082505, 2031485, 2035936, 2049324, 2083527, 2089359, 2103321, 6455, 2100275, 2049710, 2099255, 2005838, 2029152, 2052300, 2101036, 2010627, 2107143, 2092958, 2104446, 2048382, 2093380, 2006758, 2051728, 2006664, 2027896, 2073501, 2000022, 2042170, 2040244, 2008962, 2106221, 2053217, 2028039, 2117153, 2003931, 2000835, 2030680, 2091353, 2075803, 2106636, 2113253, 2036989, 2071776, 2080888, 2102132, 2104572, 2117837, 2117196, 2022049, 2027489, 2068368, 2083333, 2084084, 2088471, 2088867, 2039372, 2117412, 2002808, 2002845, 2013276, 2014182, 2015320, 2024536, 2031724, 2056887, 2065889, 2070301, 2106879, 2088272, 2095968, 2108532, 2020932, 2024595, 2049083, 2081054, 2087670, 2089127, 2091645, 2099502, 2098976, 2050171, 2051703, 2077933, 2079211, 2083179, 2084644, 2093028, 2103612, 2088826, 2097446, 2074146, 2084739, 2086510, 2086676, 2091776, 2091902, 2109128, 2102380, 2106308, 2115667, 2064379, 2066544, 2068866, 2070529, 2074373, 2082244, 2083349, 2093144, 2099838, 2101610, 2054595, 2076613, 2085836, 2087186, 2090914, 2091350, 2100028, 2103807, 2104254, 2069021, 2072048, 2073736, 2076653, 2086081, 2089966, 2092081, 2104459, 2108360, 2109917, 2014576, 2073294, 2076218, 2078121, 2080859, 2092435, 2104470, 2064918, 2074618, 2074994, 2075812, 2075912, 2076368, 2078656, 2098774, 2098968, 2067473, 2001630, 2006880, 2018505, 2025560, 2061570, 2063052, 2064085, 2069946, 2070392, 2070440, 2070510, 2074380, 2090225, 2090791, 2095199, 2098068, 2111795, 2036457, 2096840, 2106799, 2085986, 2086894, 2113953, 2078870, 2079680, 2085397, 2087842, 2087912, 2097602, 2102244, 2105092, 2106257, 2063945, 2075379, 2077882, 2085915, 2088212, 2084977, 2089002, 2079947, 2072368, 2070106, 2092678, 2088841, 2085257, 2084315, 2100495, 2073564, 2104112, 2091561, 2075828, 2106793, 2079460, 2088290, 2086575, 2072200, 2103553, 2049895, 2085332, 2085375, 2088283, 2083452, 2076818, 2084285, 2083197, 2085588, 2076060, 2089651, 2073787, 2080619, 2097485, 2075041, 2100925, 2086518, 2071020, 2104309, 2078341, 2093894, 2107108, 2064618, 2075103, 2085283, 2086237, 2082583, 2077542, 2062914, 2088066, 2096497, 2105387, 2066315, 2078308, 2073731, 2084847, 2086366, 2101744, 2093349, 2107399, 2096424, 2084811, 2110457, 2095551, 2084627, 2082510, 2095979, 2067983, 2096576, 2084122, 2084407, 2081365, 2089169, 2084884, 2083194, 2091954, 2086283, 2094300, 2092736, 2103262, 2081943, 2084399, 2088223, 2079242, 2093474, 2106684, 2077029, 2102951, 2086299, 2079283, 2090261, 2106931, 2089675, 2096737, 2092287, 2099009, 2066406, 2055174, 2081909, 2085947, 2086212, 2054146, 2085037, 2112904, 2081839, 2083597, 2079092, 2091054, 2071983, 2081905, 2074513, 2108640, 2072597, 2094438, 2091472, 2079609, 2109535, 2106420, 2073034, 2081582, 2087002, 2087853, 2091731, 2069682, 2071121, 2084743, 2080382, 2102356, 2105912, 2108072, 2068697, 2088386, 2073691, 2081726, 2106331, 2087708, 2072695, 2089103, 2085033, 2063992, 2091601, 2087557, 2090081, 2069148, 2084101, 2082976, 2097697, 2079267, 2077351, 2087877, 2096142, 2100571, 2100869, 2086903, 2090802, 2101368, 2086127, 2077701, 2098489, 2080564, 2098672, 2074426, 2081284, 2102660, 2084334, 2071306, 2076405, 2100521, 2074191, 2109631, 2069798, 2079207, 2100992, 2057253, 2104435, 2091005, 2085974, 2090089, 2102403, 2075718, 2081906, 2083723, 2086186, 2087589, 2085983, 2085130, 2071347, 2088470, 2077223, 2086592, 2085131, 2087787, 2080188, 2075759, 2084574, 2104148, 2094031, 2081148, 2088445, 2097126, 2081418, 2102299, 2072271, 2078785, 2066466, 2092399, 2091732, 2087771, 2068353, 2086080, 2077594, 2067384, 2074218, 2082886, 2081478, 2096801, 2070166, 2075027, 2092024, 2079982, 2084550, 2102490, 2071692, 2092780, 2082243, 2095083, 2083386, 2094068, 2092870, 2085230, 2086444, 2070139, 2077446, 2065184, 2081612, 2109935, 2082044, 2106004, 2084987, 2086580, 2063633, 2091041, 2112189, 2104337, 2082639, 2077961, 2088664, 2110347, 2082866, 2095813, 2090127, 2077822, 2100891, 2071597, 2082182, 2069813, 2094297, 2064813, 2074232, 2081936, 2084002, 2079290, 2085364, 2080961, 2110465, 2096427, 2088446, 2086027, 2098839, 2091587, 2080522, 2078409, 2079741, 2086015, 2083507, 2089765, 2085626, 2089655, 2072248, 2074015, 2083775, 2092753, 2106199, 2101357, 2084233, 2075686, 2082838, 2084954, 2089853, 2086718, 2088496, 2072203, 2091765, 2080846, 2062578, 2094737, 2081223, 2076777, 2090656, 2093030, 2087468, 2085332, 2070295, 2085231, 2100013, 2099637, 2080159, 2108673, 2082789, 2104471, 2065228, 2079649, 2045467, 2081615, 2078118, 2104497, 2080199, 2074323, 2090965, 2090831, 2087108, 2106446, 2084761, 2081170, 2103076, 2085830, 2084542, 2077475, 2104212, 2074523, 2872, 2048252, 1550, 1132, 1464, 3453, 1703, 3727, 3262, 1060, 1556, 3582, 644, 2047956, 3330, 1824, 1420, 3114, 3903, 2510, 4001, 1411, 1255, 2095466, 2053518, 3833, 2040435, 1676, 3802, 2050402, 1412, 2130, 2080121, 1840, 1758, 2206, 3062, 1092, 1580, 2941, 2275, 1976, 3002, 1322, 3556, 2075789, 2271, 3126, 586, 1285, 3687, 1547, 3949, 2053374, 2516, 2457, 1528, 3443, 2066946, 3473, 1174, 1682, 3501, 2889, 1731, 1728, 1715, 3718, 2908, 1569, 2769, 2980, 2701, 1648, 2447, 1492, 2065287, 1254, 4024, 3058, 771, 2307, 2659, 2408, 2431, 2046407, 2693, 1654, 2421, 1732, 3940, 1771, 1666, 808, 1876, 2054981, 2852, 1274, 1662, 1292, 2070327, 2696, 2229, 2053491, 1993, 1538, 1700, 3053, 1600, 1748, 3033, 1427, 2075847, 2140, 3785, 1334, 2082786, 2064588, 3057, 3308, 2263, 1145, 2059656, 3492, 488, 2005081, 3772, 3236, 3301, 1167, 3722, 2587, 3605, 1169, 4039, 2497, 2071, 2785, 2551, 678, 2837, 3828, 3520, 3183, 3278, 3842, 2044, 2173, 2046235, 1356, 2083002, 2078402, 1927, 1691, 2066, 3493, 1229, 2088735, 2886, 3623, 3138, 1449, 2063213, 1750, 1409, 1061, 3265, 1416, 2729, 3335, 2054668, 3814, 1671, 1282, 3757, 3778, 1454, 2915, 2625, 2488, 2078171, 2202, 1475, 1518, 1621, 1400, 2075074, 2063632, 2394, 1335, 2427, 2957, 1741, 3951, 2610, 2070515, 3995, 2960, 1597, 1339, 7211, 2160, 1903, 2055275, 2046435, 896, 700, 3807, 885, 3096, 1792, 1237, 1114, 3418, 2055239, 3463, 2562, 2496, 1452, 2247, 1579, 3285, 2077, 1451, 1919, 3509, 1153, 2722, 3404, 3597, 1661, 1399, 2056870, 1665, 3661, 1318, 1469, 4125, 892, 2410, 1600, 2004504, 3655, 3702, 3142, 2572, 1901, 3592, 2089321, 1772, 2083707, 2151, 3022, 1612, 1757, 2977, 3152, 2059430, 1447, 2051754, 2232, 3050, 1500, 3436, 3208, 1630, 2108, 2436, 1129, 4074, 2420, 2946, 1628, 3963, 2047557, 3438, 1881, 1592, 2046491, 3451, 2445, 1349, 2344, 1992, 2087865, 1723, 4165, 1306, 3522, 4081, 2678, 2912, 1877, 2883, 3694, 3831, 3292, 2053725, 2577, 1880, 1982, 3820, 1949, 2214, 1646, 3308, 2964, 3402, 1482, 2779, 1563, 2050879, 2583, 3824, 2666, 2347, 2262, 2067974, 1685, 2673, 1562, 2062789, 2377, 3643, 3545, 3650, 2601, 1226, 1930, 2981, 3504, 3226, 2051692, 4016, 3948, 3895, 1536, 2035942, 622, 2375, 1671, 1772, 3965, 4104, 3022, 1152, 1803, 1147, 2288, 3899, 1085, 1742, 1279, 3591, 1963, 2090940, 2091108, 2095800, 2090937, 2091115, 2091175, 2091156, 2091065, 2091083, 2091121, 2091134, 2091589
)
	
	
	2085128, 2056371, 2107772, 2014588, 2067709, 2117153, 2092178, 2101696, 2108856, 2102662, 2071256, 2008875, 2078586, 2091769, 2022915, 2046958, 2096680, 2103367, 2046231, 2106983, 2097094, 2005453, 2012818, 2070766, 2047151, 2096302, 2105538, 2107907, 2106893, 2111446, 2049117, 2082505, 2031485, 2085607, 2038114, 2090389, 2086063, 2048558, 2106221, 2085490, 2086034, 2060920, 2003838, 2103450, 2076003, 2058682, 2076084, 2102491, 2107566, 2006664, 2084230, 2004937, 2108592, 2101330, 2085356, 2109614, 2105571, 2069842, 2064521, 2081000, 2085760, 2101807, 2066798, 2083527, 2103192, 2073049, 2003718, 2061570, 2111100, 2107798, 2099449, 2071962, 2101879, 2087267, 2086484, 2099277, 2054867, 2034693, 2063461, 2068283, 2110271, 2052784, 2040955, 2055919, 2064394, 2080466, 2084795, 2077307, 2112309, 2108107, 2113121, 2060941, 2018955, 2094428, 2101735, 2110143, 2091629, 2071821, 2081072, 2010627, 2005757, 2082125, 2100275, 2097141, 2036765, 2006758, 2027197, 2097657, 2100324, 2114405, 2102156, 2099255, 2111657, 2084374, 2085150, 2038343, 2005838, 2003371, 2004302, 2038046, 2000932, 2056201, 2082302, 2076035, 2101745, 2079031, 2058664, 2064410, 2113253, 2108972, 2098560, 2105255, 2094389, 2063362, 2087832, 2076357, 2096010, 2031179, 2089658, 2060735, 2073898, 2092462, 2080858, 2116516, 2070594, 2035298, 2080962, 2052648, 2078447, 2067717, 2112794, 2088081, 2104107, 2104480, 2101716, 2000138, 2083012, 2032255, 2019132, 2085777, 2008686, 2092591, 2051728, 2077333, 2079536, 2087129, 2086255, 2002811, 2042803, 2039584, 2111741, 2107785, 2108020, 2103903, 2039344, 2018300, 2029563, 2101704, 2053062, 2100273, 2071026, 2070503, 2070259, 2004105, 2045027, 2014976, 2086070, 2085036, 2105338, 2072876, 2093217, 2070058, 2035318, 2101462, 2112410, 2104159, 2086643, 2109135, 2049790, 2067335, 2086834, 2030939, 2012306, 2027231, 2093380, 2082960, 2075033, 2065229, 2055573, 2089077, 2111959, 2089557, 2103210, 2104178, 2104446, 2081518, 2050303, 2036439, 2087921, 2007720, 2000098, 2029881, 2030984, 2061966, 2004733, 2069126, 2000223, 2013898, 2040244, 2038062, 2030186, 2013905, 2091758, 2044514, 2106094, 2112090, 2106821, 2075803, 2076044, 2012960, 2110159, 2064709, 2030769, 2027896, 2081219, 2035936, 2042775, 2089033, 2000597, 2019834, 2037100, 2042170, 2110522, 2059247, 2105139, 2112442, 2111956, 2048382, 2053217, 2058501, 2049526, 2097692, 2093769, 2101096, 2074858, 2076082, 2079418, 2037905, 2049711, 2053207, 2063456, 2087418, 2084604, 2005009, 2048812, 2111329, 2113344, 2112731, 2083671, 2087965, 2078863, 2084879, 2105524, 2051495, 2002144, 2093540, 2104843, 2061858, 2099622, 2042045, 2086577, 2075951, 2087040, 2087036, 2053284, 2060633, 2082193, 2111636, 2108798, 2112875, 2100874, 2069534, 2102966, 2066202, 2054391, 2098084, 2088344, 2094988, 2093341, 2084421, 2080880, 2064667, 2079264, 2018318, 2065246, 2062990, 2072824, 2108365, 2104382, 2107701, 2083075, 2032478, 2092005, 2051875, 2100552, 2047491, 2082844, 2098462, 2029499, 2066310, 2055763, 2067272, 2095404, 2000637, 2106587, 2108597, 2112749, 2111478, 2104563, 2068686, 2100881, 2048784, 2097498, 2096122, 2063319, 2091353, 2110555, 2100047, 2014995, 2001671, 2052848, 2073809, 2085164, 2090026, 2072713, 2065505, 2049710, 2108088, 2108302, 2107267, 2054035, 2011519, 2037435, 2056179, 2036516, 2099550, 2110760, 2025169, 2112873, 2001141, 2076111, 2040318, 2008962, 2087381, 2060931, 2110051, 2092077, 2111730, 2105811, 2103368, 2036989, 2115648, 2099121, 2089444, 2028039, 2108764, 2084009, 2003503, 2091283, 2052300, 2029152, 2037995, 2078304, 2089359, 2101036, 2086413, 2097993, 2053685, 2028627, 2113915, 2087773, 2110467, 2000022, 2055019, 2094250, 2065307, 2075783, 2039095, 2015478, 2068101, 2053381, 2007956, 2069182, 2090689, 2089981, 2107726, 2095732, 2049959, 2105356, 2105771, 2111492, 2087616, 2088506, 2030680, 2066752, 2096531, 2049830, 2113858, 2080294, 2106139, 2097981, 2079560, 2039059, 2063865, 2112384, 2110159, 2068658, 2078835, 2088088, 2113070, 2110609, 2004589, 2105294, 2019537, 2082075, 2020588, 2115367, 2031457, 2095403, 2014817, 2068658, 2110522, 2033561, 2089766, 2007012, 2025518, 2077590, 2053747, 2078539, 2109686, 2090960, 2084413, 2104633, 2107143, 2109412, 2001670, 2029047, 2049324, 2013108, 2015283, 2000835, 2117196, 2021400, 2046187, 2003931, 2032757, 2089715
	)
	
	
	(
	2003371, 2049526, 2089715, 2032757, 2055019, 2000932, 2038343, 2013108, 2004302, 2056201, 2046187, 2000022, 2038046, 2058501, 2003931, 2021400, 2100275, 2049324, 2001670, 2005838, 2006758, 2108764, 2048382, 2003503, 2027197, 2053685, 2102156, 2059247, 2036765, 2010627, 2085150, 2029047, 2090960, 2071821, 2037995, 2091629, 2019834, 2028627, 2000597, 2000835, 2015283, 2110143, 2091283, 2111657, 2110522, 2084009, 2089359, 2097993, 2005757, 2037100, 2052300, 2036989, 2101735, 2053217, 2101036, 2109686, 2028039, 2029152, 2084413, 2078304, 2099255, 2082125, 2117196, 2084374, 2066752, 2072876, 2111329, 2100273, 2048812, 2012960, 2069842, 2025169, 2088081, 2113070, 2083012, 2007012, 2000223, 2105139, 2078447, 2042775, 2081072, 2079264, 2068686, 2071962, 2012306, 2094389, 2086643, 2115367, 2099622, 2103210, 2055919, 2112749, 2097657, 2060633, 2089077, 2040955, 2107785, 2076082, 2076044, 2053747, 2088344, 2030769, 2056179, 2014976, 2107726, 2030984, 2084604, 2060941, 2029881, 2013898, 2113253, 2111730, 2100881, 2067717, 2069534, 2101807, 2104843, 2092178, 2067272, 2092462, 2097981, 2105338, 2014995, 2105356, 2079031, 2018300, 2083527, 2062990, 2065246, 2047491, 2072713, 2036439, 2111100, 2048558, 2014588, 2106893, 2060931, 2104107, 2046231, 2086063, 2090389, 2112309, 2000637, 2087267, 2076084, 2101462, 2000098, 2101696, 2069182, 2000138, 2072824, 2077590, 2038062, 2111636, 2093341, 2068658, 2097094, 2053062, 2063362, 2081518, 2051875, 2113915, 2063865, 2040318, 2101704, 2082505, 2108302, 2037905, 2108365, 2086834, 2089766, 2049959, 2099550, 2093380, 2116516, 2104633, 2085777, 2049710, 2085490, 2089033, 2106094, 2049790, 2102491, 2101745, 2108597, 2078863, 2075803, 2113344, 2112873, 2097692, 2060735, 2096302, 2064521, 2079536, 2079418, 2030680, 2110609, 2112442, 2110159, 2087965, 2042803, 2080880, 2052784, 2075783, 2087832, 2068101, 2011519, 2076035, 2055763, 2006664, 2089444, 2104178, 2109614, 2101096, 2077333, 2105255, 2012818, 2081000, 2020588, 2095404, 2076357, 2111478, 2100324, 2076111, 2032255, 2078835, 2082075, 2089557, 2103367, 2086577, 2049830, 2089981, 2080466, 2053207, 2112794, 2070594, 2070259, 2069126, 2005453, 2063319, 2054867, 2018318, 2108020, 2086484, 2056371, 2088088, 2032478, 2019537, 2038114, 2112384, 2108592, 2045027, 2108972, 2087616, 2039344, 2105811, 2105771, 2085607, 2004589, 2084421, 2084230, 2079560, 2083671, 2097498, 2078539, 2035298, 2085036, 2067335, 2033561, 2098084, 2053381, 2107798, 2092077, 2066202, 2008962, 2065505, 2097141, 2070503, 2111446, 2085164, 2008875, 2104480, 2085128, 2008686, 2103192, 2046958, 2101330, 2087418, 2087129, 2087381, 2054391, 2052648, 2036516, 2110555, 2108107, 2092591, 2050303, 2058664, 2091353, 2117153, 2105538, 2112410, 2095732, 2055573, 2108856, 2108798, 2093217, 2090689, 2099121, 2075033, 2029563, 2040244, 2051728, 2087773, 2022915, 2106587, 2082193, 2027231, 2070766, 2037435, 2085356, 2107267, 2061966, 2004733, 2013905, 2030186, 2104382, 2106139, 2071256, 2103450, 2073809, 2003838, 2110271, 2073898, 2107143, 2061858, 2095403, 2030939, 2112090, 2087040, 2078586, 2007720, 2082960, 2107566, 2112731, 2105294, 2086255, 2108088, 2035936, 2106221, 2084879, 2070058, 2111741, 2111956, 2094250, 2052848, 2099277, 2101879, 2061570, 2005009, 2042045, 2104446, 2007956, 2106983, 2076003, 2051495, 2039059, 2104563, 2065229, 2114405, 2064410, 2081219, 2048784, 2029499, 2100552, 2039095, 2053284, 2090026, 2085760, 2080962, 2064667, 2115648, 2092005, 2031457, 2107772, 2091758, 2031179, 2015478, 2058682, 2004937, 2098462, 2105524, 2088506, 2004105, 2066798, 2103903, 2044514, 2098560, 2080294, 2075951, 2080858, 2002144, 2103368, 2073049, 2003718, 2060920, 2113858, 2111492, 2086034, 2087036, 2049711, 2002811, 2035318, 2099449, 2106564, 2093540, 2067709, 2100047, 2015493, 2086070, 2064709, 2063456, 2025518, 2101716, 2093769, 2049117, 2065307, 2107907, 2100874, 2077307, 2034693, 2102966, 2110522, 2089658, 2096010, 2039584, 2110051, 2087921, 2042170, 2014817, 2091769, 2113121, 2104159, 2083075, 2047151, 2063461, 2102662, 2071026, 2001671, 2094988, 2094428, 2096680, 2066310, 2064394, 2112875, 2082844, 2110467, 2074858, 2105571, 2001141, 2019132, 2054035, 2096531, 2018955, 2084795, 2107701, 2109412, 2106821, 2082302, 2027896, 2111959, 2068283, 2031485, 2109135, 2110159, 2110760, 2086413, 2096122
	)



	AND (c.contract_no IN (2000932, 2038343, 2013108, 2004302, 2000022, 2038046, 2003931, 2021400, 2001670, 2005838, 2006758, 2003503, 2027197, 2010627, 2029047, 2037995, 2019834, 2028627, 2000597, 2015283, 2005757, 2037100, 2036989, 2028039, 2029152, 2012960, 2025169, 2007012, 2000223, 2012306, 2040955, 2030769, 2014976, 2030984, 2029881, 2013898, 2014995, 2018300, 2036439, 2014588, 2000637, 2000098, 2000138, 2038062, 2040318, 2037905, 2030680, 2011519, 2006664, 2012818, 2020588, 2032255, 2005453, 2018318, 2032478, 2019537, 2038114, 2039344, 2035298, 2033561, 2008962, 2008875, 2008686, 2029563, 2040244, 2022915, 2027231, 2004733, 2013905, 2030186, 2003838, 2030939, 2035936, 2005009, 2007956, 2039059, 2029499, 2039095, 2031457, 2031179, 2015478, 2004937, 2004105, 2002144, 2003718, 2002811, 2025518, 2034693, 2039584, 2014817, 2001671, 2001141, 2019132, 2018955, 2027896, 2031485)
	OR
	c.ncn IN (
	'4642', '2049526', '2089715', '2127', '2055019', '2000932', '2038343', '2013108', '2004302', '2056201', '2046187', '2000022', '2038046', '2058501', '2003931', '2021400', '2100275', '2049324', '2001670', '2005838', '2006758', '2108764', '2048382', '2003503', '2027197', '2053685', '2102156', '2059247', '3139', '2010627', '2085150', '2029047', '2090960', '2071821', '2037995', '2091629', '2019834', '2028627', '2000597', '4167', '2015283', '2110143', '2091283', '2111657', '2110522', '2084009', '2089359', '2097993', '2005757', '2037100', '2052300', '2036989', '2101735', '2053217', '2101036', '2109686', '2028039', '2029152', '2084413', '2078304', '2099255', '2082125', '2117196', '2084374', '2066752', '2072876', '2111329', '2100273', '2048812', '2012960', '2069842', '2025169', '2088081', '2113070', '2083012', '2007012', '2000223', '2105139', '2078447', '2042775', '2081072', '2079264', '2068686', '2071962', '2012306', '2094389', '2086643', '2115367', '2099622', '2103210', '2055919', '2112749', '2097657', '2060633', '2089077', '2040955', '2107785', '2076082', '2076044', '2053747', '2088344', '2030769', '2056179', '2014976', '2107726', '2030984', '2084604', '2060941', '2029881', '2013898', '2113253', '2111730', '2100881', '2067717', '2069534', '2101807', '2104843', '2092178', '2067272', '2092462', '2097981', '2105338', '2014995', '2105356', '2079031', '2018300', '2083527', '2062990', '2065246', '2047491', '2072713', '2036439', '2111100', '2048558', '2014588', '2106893', '2060931', '2104107', '2046231', '2086063', '2090389', '2112309', '2000637', '2087267', '2076084', '2101462', '2000098', '2101696', '2069182', '2000138', '2072824', '2077590', '2038062', '2111636', '2093341', '2068658', '2097094', '2053062', '2063362', '2081518', '2051875', '2113915', '2063865', '2040318', '2101704', '2082505', '2108302', '2037905', '2108365', '2086834', '2089766', '2049959', '2099550', '2093380', '2116516', '2104633', '2085777', '2049710', '2085490', '2089033', '2106094', '2079790', '2102491', '2101745', '2108597', '2078863', '2075803', '2113344', '2112873', '2097692', '2060735', '2096302', '2064521', '2079536', '2079418', '2030680', '2110609', '2112442', '2110159', '2087965', '2042803', '2080880', '2052784', '2075783', '2087832', '2068101', '2011519', '2076035', '2055763', '2006664', '2089444', '2104178', '2109614', '2101096', '2077333', '2105255', '2012818', '2081000', '2020588', '2095404', '2076357', '2111478', '2100324', '2076111', '2032255', '2078835', '2082075', '2089557', '2103367', '2086577', '2049830', '2089981', '2080466', '2053207', '2112794', '2070594', '2070259', '2069126', '2005453', '2063319', '2054867', '2018318', '2108020', '2086484', '2056371', '2088088', '2032478', '2019537', '2038114', '2112384', '2108592', '2045027', '2108972', '2087616', '2039344', '2105811', '2105771', '2085607', '6455', '2084421', '2084230', '2079560', '2083671', '2097498', '2078539', '2035298', '2085036', '2067335', '2033561', '2098084', '2053381', '2107798', '2092077', '2066202', '2008962', '2065505', '2097141', '2070503', '2111446', '2085164', '2008875', '2104480', '2085128', '2008686', '2103192', '2046958', '2101330', '2087418', '2087129', '2087381', '2054391', '2052648', '3003', '2110555', '2108107', '2092591', '2050303', '2058664', '2091353', '2117153', '2105538', '2112410', '2095732', '2055573', '2108856', '2108798', '2093217', '2090689', '2099121', '2075033', '2029563', '2040244', '2051728', '2087773', '2022915', '2106587', '2082193', '2027231', '2070766', '3535', '2085356', '2107267', '2061966', '2004733', '2013905', '2030186', '2104382', '2106139', '2071256', '2103450', '2073809', '2003838', '2110271', '2073898', '2107143', '2061858', '2095403', '2030939', '2112090', '2087040', '2078586', '7061', '2082960', '2107566', '2112731', '2105294', '2086255', '2108088', '2035936', '2106221', '2084879', '2070058', '2111741', '2111956', '2094250', '2052848', '2099277', '2101879', '2061570', '2005009', '2042045', '2104446', '2007956', '2106983', '2076003', '2051495', '2039059', '2104563', '2065229', '2114405', '2064410', '2081219', '2048784', '2029499', '2100552', '2039095', '2053284', '2090026', '2085760', '2080962', '2064667', '2115648', '2092005', '2031457', '2107772', '2091758', '2031179', '2015478', '2058682', '2004937', '2098462', '2105524', '2088506', '2004105', '2066798', '2103903', '2044514', '2098560', '2080294', '2075951', '2080858', '2002144', '2103368', '2073049', '2003718', '2060920', '2113858', '2111492', '2086034', '2087036', '2049711', '2002811', '2646', '2099449', '2106564', '2093540', '2067709', '2100047', '5973', '2086070', '2064709', '2063456', '2025518', '2101716', '2093769', '2049117', '2065307', '2107907', '2100874', '2077307', '2034693', '2102966', '2110522', '2089658', '2096010', '2039584', '2110051', '2087921', '2042170', '2014817', '2091769', '2113121', '2104159', '2083075', '2047151', '2063461', '2102662', '2071026', '2001671', '2094988', '2094428', '2096680', '2066310', '2064394', '2112875', '2082844', '2110467', '2074858', '2105571', '2001141', '2019132', '2054035', '2096531', '2018955', '2084795', '2107701', '2109412', '2106821', '2082302', '2027896', '2111959', '2068283', '2031485', '2109135', '2110159', '2110760', '2086413', '2096122'
	) )



WHERE c.status IN (4, 6, 7)
	AND c.contract_no IN (2056201, 2036765, 2004589, 2000932, 2010598, 2004937, 2037435, 2015478, 2000596, 2033357, 2027978, 2030139, 2031866, 2031883, 2021088, 2032739, 2000262, 2003614, 2005468, 2005563, 2006274, 2006776, 2004854, 2003982, 2009525, 2002823, 2002640, 2002723, 2004494, 2004894, 2005102, 2003805, 2004719, 2004813, 2032757, 2049526, 2001417, 2003312, 2004886, 2001563, 2004745, 2029169, 2015493, 2004257, 2026653, 2000835, 2007720, 2053358, 2055550, 2057387, 2057048, 2053747, 2051384, 2057584, 2053870, 2056205, 2013108, 2008446, 2008395, 2018853, 2021400, 2013192, 2012526, 2020588, 2023778, 2001670, 2031878, 2000988, 2046187, 2054037, 2012804, 2001479, 2000099, 2055256, 2045384, 2056211, 2055809, 2057007, 2005732, 2045892, 2057960, 2056877, 2059427, 2056908, 2059817, 2060018, 2056372, 2053026, 2059012, 2045638, 2058549, 2056059, 2051043, 2040142, 2039059, 2018688, 2012169, 2010416, 2040101, 2040755, 2042502, 2041207, 2041463, 2041141, 2021058, 2024727, 2040955, 2043819, 2036989, 2036516, 2035318, 2015283, 2027706, 2008962, 2028039, 2029881, 2025169, 2029047, 2080880, 2014817, 2012967, 2043611, 2052784, 2064521, 2089715, 2097241, 2099790, 2100527, 2095718, 2082354, 2093573, 2098745, 2099430, 2088459, 2092762, 2095220, 2089140, 2098396, 2099597, 2097242, 2101292, 2096307, 2099790, 2101344, 2064521
,
2060920, 2000138, 2000637, 2019834, 2082960, 2093540, 2086034, 2086484, 2087040, 2094428, 2109614, 2067709, 2076035, 2108088, 2092178, 2109686, 2110051, 2053217, 2055919, 2006758, 2027231, 2042045, 2014995, 2085777, 2112873, 2115367, 2079536, 2048382, 2068283, 2076111, 2036439, 2037995, 2111959, 2099121, 2112384, 2106624, 2010627, 2000098, 2003371, 2014976, 2019537, 2105756, 2107772, 2107907, 2000223, 2003718, 2001671, 2003931, 2084009, 2110159, 2110522, 2101745, 2056179, 2061858, 2092077, 2083671, 2086834, 2030769, 2030939, 2026829, 2031179, 2092005, 2103367, 2110271, 2044514, 2116516, 2038062, 2047491, 2049830, 2063865, 2110555, 2065229, 2070058, 2070259, 2071026, 2087832, 2116512, 2072713, 2002144, 2067272, 2097692, 2060735, 2108592, 2046231, 2111741, 2091758, 2097141, 2073898, 2068686, 2099622, 2053685, 2100874, 2004302, 2008875, 2018300, 2018318, 2019132, 2037905, 2049711, 2063362, 2085150, 2096010, 2094250, 2094389, 2008962, 2028039, 2029152, 2038114, 2063456, 2066202, 2070594, 2077333, 2078447, 2079790, 2000022, 2034693, 2035936, 2004105, 2004733, 2035298, 2039584, 2052848, 2089981, 2064410, 2082302, 2087129, 2104843, 2093341, 2105338, 2048558, 2055573, 2083012, 2085164, 2110143, 2101036, 2107726, 2049710, 2079031, 2049324, 2060931, 2071256, 2075033, 2088081, 2051875, 2039344, 2053284, 2061966, 2077307, 2089359, 2042803, 2076082, 2081518, 2086643, 2101096, 2090026, 2073578, 2082125, 2097498, 2075783, 2079418, 2085128, 2085356, 2022915, 2027197, 2031457, 2038343, 2071962, 2027896, 2083527, 2089557, 2094988, 2003503, 2012818, 2029563, 2050303, 2067717, 2068101, 2073049, 2075951, 2078586, 2086255, 2087616, 2087921, 2087965, 2092591, 2093769, 2069182, 2111657, 2089658, 2098462, 2060941, 2082844, 2102966, 2103192, 2047151, 2003838, 2008686, 2025518, 2042170, 2030984, 2043588, 2032255, 2078539, 2079264, 2106587, 2115648, 2011519, 2048812, 2074858, 2106983, 2055019, 2063319, 2076044, 2082193, 2086063, 2086577, 2095403, 2095732, 2105538, 2100881, 2101704, 2001141, 2039095, 2005009, 2060633, 2073809, 2080858, 2083075, 2100047, 2100273, 2100275, 2087418, 2088506, 2052300, 2007956, 2085036, 2091769, 2076357
)
;








-- GPS status checking
SELECT 
	c.contract_no,
	CASE
		WHEN av.offline_status = 0 THEN 'Online'
		WHEN av.offline_status = 1 THEN 'Offline'
		ELSE 'Offline'
	END AS `GPS_status`
FROM tblcontract c
LEFT JOIN tblprospect p ON (p.id = c.prospect_id)
LEFT JOIN tblprospectasset pa ON (pa.prospect_id = c.prospect_id)
LEFT JOIN tblassetvaluation av ON (av.id  = pa.assetvaluation_id)
WHERE c.status IN (4,6,7)
;


















